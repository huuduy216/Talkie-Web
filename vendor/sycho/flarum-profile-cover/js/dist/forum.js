module.exports=function(t){var o={};function e(r){if(o[r])return o[r].exports;var n=o[r]={i:r,l:!1,exports:{}};return t[r].call(n.exports,n,n.exports,e),n.l=!0,n.exports}return e.m=t,e.c=o,e.d=function(t,o,r){e.o(t,o)||Object.defineProperty(t,o,{enumerable:!0,get:r})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,o){if(1&o&&(t=e(t)),8&o)return t;if(4&o&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(e.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&o&&"string"!=typeof t)for(var n in t)e.d(r,n,function(o){return t[o]}.bind(null,n));return r},e.n=function(t){var o=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(o,"a",o),o},e.o=function(t,o){return Object.prototype.hasOwnProperty.call(t,o)},e.p="",e(e.s=17)}([function(t,o,e){"use strict";function r(t,o){if(void 0===o&&(o=2),0===t)return"0 Bytes";var e=o<0?0:o,r=Math.floor(Math.log(t)/Math.log(1024));return parseFloat((t/Math.pow(1024,r)).toFixed(e))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][r]}e.d(o,"a",(function(){return r}))},function(t,o,e){"use strict";function r(t,o){t.prototype=Object.create(o.prototype),t.prototype.constructor=t,t.__proto__=o}e.d(o,"a",(function(){return r}))},function(t,o){t.exports=flarum.core.compat["components/Button"]},function(t,o){t.exports=flarum.core.compat.extend},function(t,o){t.exports=flarum.core.compat["models/User"]},function(t,o){t.exports=flarum.core.compat.Model},function(t,o){t.exports=flarum.core.compat["utils/ItemList"]},function(t,o){t.exports=flarum.core.compat["components/UserCard"]},function(t,o){t.exports=flarum.core.compat["utils/UserControls"]},function(t,o){t.exports=flarum.core.compat["components/Alert"]},function(t,o){t.exports=flarum.core.compat["components/Modal"]},function(t,o){t.exports=flarum.core.compat["components/FieldSet"]},function(t,o){t.exports=flarum.core.compat["components/LoadingIndicator"]},,function(t,o){t.exports=flarum.core.compat["components/UserPage"]},function(t,o){t.exports=flarum.core.compat["components/Switch"]},function(t,o){t.exports=flarum.core.compat["helpers/listItems"]},function(t,o,e){"use strict";function r(){return(r=Object.assign||function(t){for(var o=1;o<arguments.length;o++){var e=arguments[o];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t}).apply(this,arguments)}e.r(o);var n=e(3),a=e(4),i=e.n(a),s=(e(14),e(7)),c=e.n(s),u=e(8),p=e.n(u),l=e(2),f=e.n(l),d=e(5),h=e.n(d),v=e(1),b=e(9),y=e.n(b),x=e(10),g=e.n(x),_=(e(15),e(11)),w=e.n(_),O=e(6),B=e.n(O),M=e(12),j=e.n(M),P=(e(16),e(0)),S=function(t){function o(){return t.apply(this,arguments)||this}Object(v.a)(o,t);var e=o.prototype;return e.init=function(){t.prototype.init.call(this),this.maxSize=parseFloat(app.data["sycho-profile-cover.max_size"]||2048),this.alert=y.a.component({children:app.translator.trans("sycho-profile-cover.forum.notice",{size:Object(P.a)(this.maxSize*Math.pow(2,10))})}),this.loading=!1,this.cover=this.props.user.cover_thumbnail()||this.props.user.cover(),this.context=""},e.content=function(){var t={},o="Modal-image CoverEditor-cover";return this.cover&&(t.style={backgroundImage:"url("+app.forum.attribute("baseUrl")+"/assets/covers/"+this.cover+")"},o+=" CoverEditor-active"),[m("div",r({className:o},t),this.loading?j.a.component():""),m("div",{className:"Modal-body"},m("div",{className:"Form"},this.fieldsItems().toArray().map((function(t){return m("div",{class:"Form-group"},m("label",null,t.props.label),t.props.children)}))))]},e.className=function(){return"Cover-modal Modal--small"},e.title=function(){return app.translator.trans("sycho-profile-cover.forum.edit_cover")},e.fieldsItems=function(){var t=new B.a;return t.add("actions",w.a.component({label:"",className:"Cover-actions",children:this.controlItems().toArray()})),t},e.controlItems=function(){var t=new B.a;return t.add("upload",f.a.component({icon:"fas fa-upload",className:"Button",children:app.translator.trans("core.forum.user.avatar_upload_button"),onclick:this.openPicker.bind(this)})),t.add("remove",f.a.component({icon:"fas fa-times",className:"Button",children:app.translator.trans("core.forum.user.avatar_remove_button"),onclick:this.remove.bind(this)})),t},e.openPicker=function(){var t=this;$('<input type="file">').appendTo("body").hide().click().on("change",(function(o){t.upload($(o.target)[0].files[0])}))},e.upload=function(t){if(!this.loading){var o=new FormData;o.append("cover",t),this.loading=!0,this.context="added",m.redraw(),app.request({method:"POST",url:app.forum.attribute("apiUrl")+"/users/"+this.props.user.id()+"/cover",serialize:function(t){return t},data:o}).then(this.success.bind(this),this.failure.bind(this))}},e.remove=function(){this.loading=!0,this.context="removed",m.redraw(),app.request({method:"DELETE",url:app.forum.attribute("apiUrl")+"/users/"+this.props.user.id()+"/cover"}).then(this.success.bind(this),this.failure.bind(this))},e.success=function(t){app.store.pushPayload(t),this.showAlert("success"),this.loading=!1,m.redraw(),this.hide()},e.failure=function(t){this.showAlert("error"),this.loading=!1,m.redraw()},e.showAlert=function(t){this.alert.props.children=app.translator.trans("sycho-profile-cover.forum."+this.context+"."+t),this.alert.props.type=t},o}(g.a);app.initializers.add("sycho-profile-cover",(function(t){i.a.prototype.cover=h.a.attribute("cover"),i.a.prototype.cover_thumbnail=h.a.attribute("cover_thumbnail"),Object(n.extend)(c.a.prototype,"view",(function(o){if(o.attrs.style){var e=this.props.user.cover(),n=this.props.user.cover_thumbnail();if(e){this.props.controlsButtonClassName.includes("Button--icon")&&n&&(e=n);var a=t.forum.attribute("baseUrl")+"/assets/covers/"+e;o.attrs.style=r(o.attrs.style,{backgroundImage:"url("+a+")"})}}})),Object(n.extend)(p.a,"moderationControls",(function(o,e){(e.canEdit()||t.session.user===e)&&o.add("cover",f.a.component({icon:"fas fa-image",children:t.translator.trans("sycho-profile-cover.forum.cover"),onclick:function(){return t.modal.show(new S({user:e}))}}))}))}))}]);
//# sourceMappingURL=forum.js.map